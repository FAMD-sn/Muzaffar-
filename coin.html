<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FamDex GALAXY ü™ê - –¢–æ—Ä–≥–æ–≤–∞—è –ò–º–ø–µ—Ä–∏—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        /* –°–ª–æ–∂–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∑–≤–µ–∑–¥ */
        .stars, .twinkling, .clouds {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            display: block;
            pointer-events: none;
            z-index: 0;
        }

        .stars {
            background: #000 url('http://www.script-tutorials.com/demos/360/images/stars.png') repeat top center;
            z-index: 0;
            animation: move-stars 200s linear infinite;
        }

        .twinkling {
            background: transparent url('http://www.script-tutorials.com/demos/360/images/twinkling.png') repeat top center;
            z-index: 1;
            animation: move-twinkling 100s linear infinite;
        }

        @keyframes move-twinkling {
            from {background-position: 0 0;}
            to {background-position: -10000px 5000px;}
        }

        @keyframes move-stars {
            from {background-position: 0 0;}
            to {background-position: 10000px 5000px;}
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        /* –•–µ–¥–µ—Ä —Å –Ω–µ–æ–Ω–æ–≤—ã–º —ç—Ñ—Ñ–µ–∫—Ç–æ–º */
        .header {
            background: rgba(10, 20, 30, 0.8);
            backdrop-filter: blur(20px);
            padding: 25px;
            border-radius: 40px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            border: 1px solid rgba(78, 205, 196, 0.3);
            box-shadow: 0 0 50px rgba(78, 205, 196, 0.2);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(78, 205, 196, 0.1) 50%,
                transparent 70%
            );
            animation: headerGlow 6s linear infinite;
        }

        @keyframes headerGlow {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .logo {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(45deg, #4ecdc4, #ff6b6b, #f3ec78);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 30px #4ecdc4);
            position: relative;
        }

        .logo::after {
            content: 'ü™ê';
            font-size: 40px;
            margin-left: 15px;
            animation: planetRotate 10s linear infinite;
            display: inline-block;
        }

        @keyframes planetRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* –ü—Ä–æ—Ñ–∏–ª—å GALAXY */
        .user-profile-card {
            background: rgba(10, 20, 30, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 50px;
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid rgba(78, 205, 196, 0.2);
            box-shadow: 0 30px 60px rgba(0,0,0,0.5), 0 0 100px rgba(78,205,196,0.2);
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 40px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .profile-avatar {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #4ecdc4, #ff6b6b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            font-weight: bold;
            color: white;
            box-shadow: 0 0 80px rgba(78, 205, 196, 0.6);
            border: 4px solid rgba(255,255,255,0.3);
            animation: avatarPulse 3s infinite;
        }

        @keyframes avatarPulse {
            0% { box-shadow: 0 0 50px #4ecdc4; }
            33% { box-shadow: 0 0 80px #ff6b6b; }
            66% { box-shadow: 0 0 50px #f3ec78; }
            100% { box-shadow: 0 0 50px #4ecdc4; }
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 56px;
            font-weight: bold;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(78,205,196,0.5);
        }

        .profile-stats {
            display: flex;
            gap: 30px;
            margin-top: 15px;
        }

        .profile-stat {
            text-align: center;
        }

        .profile-stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #4ecdc4;
        }

        .profile-stat-label {
            font-size: 14px;
            opacity: 0.7;
        }

        .profile-badge {
            display: inline-block;
            padding: 10px 35px;
            background: linear-gradient(90deg, #4ecdc4, #ff6b6b);
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 0 30px rgba(78,205,196,0.5);
        }

        /* –£–ª—É—á—à–µ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –±–∞–ª–∞–Ω—Å–∞ */
        .balance-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .balance-card {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 40px;
            padding: 35px;
            display: flex;
            align-items: center;
            gap: 25px;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(78, 205, 196, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .balance-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(78, 205, 196, 0.2), transparent);
            transition: left 0.7s;
        }

        .balance-card:hover::before {
            left: 100%;
        }

        .balance-card:hover {
            transform: translateY(-15px) scale(1.03);
            box-shadow: 0 40px 70px rgba(0,0,0,0.6), 0 0 50px rgba(78,205,196,0.3);
            border-color: #4ecdc4;
        }

        .balance-icon {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 42px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .balance-details {
            flex: 1;
        }

        .balance-label {
            font-size: 18px;
            opacity: 0.7;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .balance-amount {
            font-size: 48px;
            font-weight: bold;
            text-shadow: 0 0 30px rgba(78,205,196,0.5);
        }

        .balance-change {
            font-size: 16px;
            margin-top: 10px;
            color: #4ecdc4;
        }

        .balance-change.positive { color: #4ecdc4; }
        .balance-change.negative { color: #ff6b6b; }

        /* –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ */
        .analytics-section {
            background: rgba(10, 20, 30, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 50px;
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid rgba(78, 205, 196, 0.2);
        }

        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .analytics-title {
            font-size: 32px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .time-filters {
            display: flex;
            gap: 10px;
            background: rgba(0,0,0,0.3);
            padding: 8px;
            border-radius: 50px;
        }

        .time-filter {
            padding: 10px 25px;
            border: none;
            border-radius: 40px;
            background: transparent;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .time-filter.active {
            background: #4ecdc4;
            color: black;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .chart-card {
            background: rgba(0,0,0,0.3);
            border-radius: 40px;
            padding: 30px;
            border: 1px solid rgba(78, 205, 196, 0.2);
        }

        .chart-title {
            font-size: 24px;
            margin-bottom: 25px;
            color: #4ecdc4;
        }

        .chart-container {
            width: 100%;
            height: 300px;
            position: relative;
        }

        .mini-chart {
            height: 100px;
            margin-top: 20px;
            display: flex;
            align-items: flex-end;
            gap: 5px;
        }

        .mini-bar {
            flex: 1;
            background: linear-gradient(to top, #4ecdc4, #45b7d1);
            border-radius: 5px 5px 0 0;
            transition: height 0.3s;
            min-height: 20px;
            position: relative;
        }

        .mini-bar:hover {
            background: #ff6b6b;
        }

        .mini-bar::after {
            content: attr(data-value);
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .mini-bar:hover::after {
            opacity: 1;
        }

        /* –ü–æ—Ä—Ç—Ñ–µ–ª—å —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ */
        .portfolio-section {
            background: rgba(10, 20, 30, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 50px;
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid rgba(78, 205, 196, 0.2);
        }

        .portfolio-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .portfolio-title {
            font-size: 36px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .portfolio-total-profit {
            background: linear-gradient(90deg, #4ecdc4, #ff6b6b);
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 28px;
            font-weight: bold;
        }

        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 30px;
        }

        .portfolio-card {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 40px;
            padding: 30px;
            border: 1px solid rgba(78, 205, 196, 0.2);
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
        }

        .portfolio-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #4ecdc4, #ff6b6b);
            transform: scaleX(0);
            transition: transform 0.5s;
        }

        .portfolio-card:hover::before {
            transform: scaleX(1);
        }

        .portfolio-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 30px 60px rgba(0,0,0,0.4);
        }

        .portfolio-coin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .portfolio-coin-name {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(90deg, #4ecdc4, #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .portfolio-coin-symbol {
            background: rgba(78, 205, 196, 0.2);
            padding: 8px 20px;
            border-radius: 40px;
            border: 1px solid #4ecdc4;
        }

        .portfolio-coin-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .portfolio-coin-stat {
            text-align: center;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
        }

        .portfolio-coin-label {
            font-size: 14px;
            opacity: 0.7;
            margin-bottom: 8px;
        }

        .portfolio-coin-value {
            font-size: 22px;
            font-weight: bold;
        }

        .portfolio-coin-profit {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 30px;
        }

        .profit-positive {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
        }

        .profit-negative {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
        }

        .portfolio-coin-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .btn-sell {
            flex: 1;
            background: linear-gradient(90deg, #ff6b6b, #ee5a5a);
            color: white;
            padding: 15px;
            border: none;
            border-radius: 30px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-sell:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(255, 107, 107, 0.4);
        }

        .btn-chart {
            background: rgba(78, 205, 196, 0.2);
            color: white;
            padding: 15px;
            border: 2px solid #4ecdc4;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-chart:hover {
            background: #4ecdc4;
            color: black;
        }

        /* –ú–∞—Ä–∫–µ—Ç —Å –∫—Ä—É—Ç—ã–º–∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ */
        .market-section {
            background: rgba(10, 20, 30, 0.7);
            backdrop-filter: blur(20px);
            border-radius: 50px;
            padding: 40px;
            border: 1px solid rgba(78, 205, 196, 0.2);
        }

        .market-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .market-title {
            font-size: 42px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .market-title::before {
            content: 'üìä';
            font-size: 48px;
            animation: chartBounce 2s infinite;
        }

        @keyframes chartBounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .market-stats {
            display: flex;
            gap: 30px;
        }

        .market-stat {
            text-align: center;
        }

        .market-stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #4ecdc4;
        }

        .coins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
            gap: 30px;
        }

        .coin-card {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 40px;
            padding: 35px;
            transition: all 0.4s;
            border: 1px solid rgba(78, 205, 196, 0.2);
            position: relative;
            overflow: hidden;
        }

        .coin-card.admin-coin {
            border: 2px solid gold;
            box-shadow: 0 0 50px gold;
        }

        .coin-chart-mini {
            height: 80px;
            margin: 20px 0;
            display: flex;
            align-items: flex-end;
            gap: 3px;
        }

        .coin-chart-bar {
            flex: 1;
            background: linear-gradient(to top, #4ecdc4, #45b7d1);
            border-radius: 3px 3px 0 0;
            transition: height 0.3s;
            cursor: pointer;
        }

        .coin-chart-bar:hover {
            background: #ff6b6b;
        }

        .coin-price-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
        }

        .coin-price {
            font-size: 48px;
            font-weight: bold;
            color: #4ecdc4;
            text-shadow: 0 0 30px rgba(78,205,196,0.5);
        }

        .coin-price-change {
            font-size: 24px;
            padding: 10px 25px;
            border-radius: 40px;
        }

        .change-positive {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
        }

        .change-negative {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
        }

        .coin-supply {
            font-size: 18px;
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 30px;
            text-align: center;
        }

        .coin-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .buy-section {
            flex: 2;
            display: flex;
            gap: 10px;
        }

        .buy-section input {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 30px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border: 2px solid rgba(78, 205, 196, 0.3);
            font-size: 16px;
        }

        .buy-section input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 40px rgba(78,205,196,0.3);
        }

        .btn-buy {
            background: linear-gradient(90deg, #4ecdc4, #45b7d1);
            color: white;
            padding: 18px 35px;
            border: none;
            border-radius: 30px;
            font-weight: bold;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.4s;
            white-space: nowrap;
        }

        .btn-buy:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 50px rgba(78, 205, 196, 0.5);
        }

        .btn-delete {
            background: linear-gradient(90deg, #ff6b6b, #ee5a5a);
            color: white;
            padding: 18px 25px;
            border: none;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.4s;
            flex: 1;
        }

        .btn-delete:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(255, 107, 107, 0.5);
        }

        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-panel {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
            padding: 50px;
            border-radius: 60px;
            margin-bottom: 40px;
            border: 3px solid gold;
            box-shadow: 0 0 100px gold;
        }

        .admin-panel h2 {
            margin-bottom: 40px;
            color: gold;
            font-size: 42px;
            text-shadow: 0 0 40px gold;
        }

        .create-coin-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }

        .form-group label {
            color: gold;
            font-size: 18px;
            margin-bottom: 10px;
            display: block;
        }

        .form-group input {
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,215,0,0.3);
            padding: 18px;
            border-radius: 30px;
            color: white;
            font-size: 16px;
        }

        .form-group input:focus {
            border-color: gold;
            box-shadow: 0 0 40px gold;
        }

        .btn-create {
            background: linear-gradient(90deg, gold, orange);
            color: black;
            padding: 18px 50px;
            border: none;
            border-radius: 40px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.4s;
            box-shadow: 0 10px 40px gold;
        }

        .btn-create:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 30px 70px gold;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .toast {
            position: fixed;
            bottom: 40px;
            right: 40px;
            background: linear-gradient(90deg, #4ecdc4, #45b7d1);
            color: white;
            padding: 25px 50px;
            border-radius: 60px;
            animation: slideInRight 0.5s, float 3s infinite;
            z-index: 1000;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 50px #4ecdc4;
            font-size: 20px;
            font-weight: bold;
            border: 2px solid white;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .hidden { display: none; }
    </style>
    <!-- Chart.js –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="stars"></div>
    <div class="twinkling"></div>

    <div class="container">
        <!-- –•–µ–¥–µ—Ä -->
        <div class="header">
            <div class="logo">FamDex GALAXY</div>
            <div class="user-info">
                <div id="authSection" class="auth-section">
                    <input type="text" id="loginUsername" placeholder="–ò–º—è">
                    <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å">
                    <button onclick="login()" class="btn-login">üöÄ –í–æ–π—Ç–∏</button>
                    <span class="register-link" onclick="showRegister()">‚ú® –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
                </div>
                <div id="registerSection" class="auth-section hidden">
                    <input type="text" id="regUsername" placeholder="–ò–º—è">
                    <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å">
                    <input type="password" id="regConfirmPassword" placeholder="–ü–æ–≤—Ç–æ—Ä–∏">
                    <button onclick="register()" class="btn-login">‚≠ê –°–æ–∑–¥–∞—Ç—å</button>
                    <span class="register-link" onclick="showLogin()">‚Ü©Ô∏è –ù–∞–∑–∞–¥</span>
                </div>
                <div id="userInfo" class="hidden">
                    <button onclick="logout()" class="btn-logout">üëã –í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
        <div id="userProfile" class="hidden">
            <div class="user-profile-card">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">U</div>
                    <div class="profile-info">
                        <div class="profile-name" id="profileName">–¢—Ä–µ–π–¥–µ—Ä</div>
                        <div class="profile-badge" id="profileBadge">üåü –ù–û–í–ò–ß–û–ö</div>
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="totalTrades">0</div>
                                <div class="profile-stat-label">–°–¥–µ–ª–æ–∫</div>
                            </div>
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="winRate">0%</div>
                                <div class="profile-stat-label">–£—Å–ø–µ—Ö</div>
                            </div>
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="totalProfit">0</div>
                                <div class="profile-stat-label">–ü—Ä–∏–±—ã–ª—å</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ë–∞–ª–∞–Ω—Å -->
                <div class="balance-cards">
                    <div class="balance-card">
                        <div class="balance-icon">üí∞</div>
                        <div class="balance-details">
                            <div class="balance-label">USDT –ë–ê–õ–ê–ù–°</div>
                            <div class="balance-amount" id="usdtBalance">0</div>
                            <div class="balance-change positive" id="usdtChange">+0% —Å–µ–≥–æ–¥–Ω—è</div>
                        </div>
                    </div>
                    <div class="balance-card">
                        <div class="balance-icon">üìä</div>
                        <div class="balance-details">
                            <div class="balance-label">–ü–û–†–¢–§–ï–õ–¨</div>
                            <div class="balance-amount" id="portfolioValue">0</div>
                            <div class="balance-change" id="portfolioChange">0 USDT</div>
                        </div>
                    </div>
                    <div class="balance-card">
                        <div class="balance-icon">üíé</div>
                        <div class="balance-details">
                            <div class="balance-label">–û–ë–©–ê–Ø –ü–†–ò–ë–´–õ–¨</div>
                            <div class="balance-amount" id="totalProfitAmount">0</div>
                            <div class="balance-change" id="profitPercent">0%</div>
                        </div>
                    </div>
                </div>

                <!-- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ -->
                <div class="deposit-section">
                    <div class="deposit-title">üí∞ –ü–û–ü–û–õ–ù–ò–¢–¨ –ë–ê–õ–ê–ù–°</div>
                    <div class="deposit-form">
                        <input type="number" id="depositAmount" placeholder="–°—É–º–º–∞ USDT">
                        <button onclick="depositMoney()" class="btn-deposit">‚ú® –ü–û–ü–û–õ–ù–ò–¢–¨</button>
                    </div>
                </div>
            </div>

            <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –≥—Ä–∞—Ñ–∏–∫–∏ -->
            <div class="analytics-section">
                <div class="analytics-header">
                    <div class="analytics-title">üìà –ê–ù–ê–õ–ò–¢–ò–ö–ê –ü–û–†–¢–§–ï–õ–Ø</div>
                    <div class="time-filters">
                        <button class="time-filter active" onclick="changeTimeframe('day')">–î–µ–Ω—å</button>
                        <button class="time-filter" onclick="changeTimeframe('week')">–ù–µ–¥–µ–ª—è</button>
                        <button class="time-filter" onclick="changeTimeframe('month')">–ú–µ—Å—è—Ü</button>
                        <button class="time-filter" onclick="changeTimeframe('year')">–ì–æ–¥</button>
                    </div>
                </div>
                
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-title">üìä –î–ò–ù–ê–ú–ò–ö–ê –ü–û–†–¢–§–ï–õ–Ø</div>
                        <div class="chart-container">
                            <canvas id="portfolioChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">ü•ß –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ú–û–ù–ï–¢</div>
                        <div class="chart-container">
                            <canvas id="distributionChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- –ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫–∏ -->
                <div class="mini-chart" id="miniChart">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </div>
            </div>

            <!-- –ü–æ—Ä—Ç—Ñ–µ–ª—å –º–æ–Ω–µ—Ç -->
            <div class="portfolio-section">
                <div class="portfolio-header">
                    <div class="portfolio-title">üíº –ú–û–ô –ü–û–†–¢–§–ï–õ–¨ –ú–û–ù–ï–¢</div>
                    <div class="portfolio-total-profit" id="totalPortfolioProfit">üí∞ +0 USDT</div>
                </div>
                <div id="portfolioContainer" class="portfolio-grid">
                    <!-- –ü–æ—Ä—Ç—Ñ–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
                </div>
            </div>
        </div>

        <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
        <div id="adminPanel" class="admin-panel hidden">
            <h2>üëë –ê–î–ú–ò–ù –í–°–ï–õ–ï–ù–ù–û–ô (–ë–ï–°–ö–û–ù–ï–ß–ù–´–ô –ë–ê–õ–ê–ù–°)</h2>
            <div class="create-coin-form">
                <div class="form-group">
                    <label>üåç –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–Ω–µ—Ç—ã</label>
                    <input type="text" id="coinName" placeholder="Galaxy Coin">
                </div>
                <div class="form-group">
                    <label>‚ö° –°–∏–º–≤–æ–ª</label>
                    <input type="text" id="coinSymbol" placeholder="GXY">
                </div>
                <div class="form-group">
                    <label>üíé –¶–µ–Ω–∞ (USDT)</label>
                    <input type="number" id="coinPrice" placeholder="100" min="0.01">
                </div>
                <div class="form-group">
                    <label>üì¶ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</label>
                    <input type="number" id="coinSupply" placeholder="1000000" min="1">
                </div>
                <div class="form-group">
                    <label>üìà –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å %</label>
                    <input type="number" id="coinVolatility" placeholder="5" min="0" max="100">
                </div>
                <button onclick="createCoin()" class="btn-create">‚ú® –°–û–¢–í–û–†–ò–¢–¨ –ú–û–ù–ï–¢–£</button>
            </div>
        </div>

        <!-- –ú–∞—Ä–∫–µ—Ç -->
        <div class="market-section">
            <div class="market-header">
                <div class="market-title">üåå –ö–û–°–ú–ò–ß–ï–°–ö–ò–ô –ú–ê–†–ö–ï–¢</div>
                <div class="market-stats">
                    <div class="market-stat">
                        <div class="market-stat-value" id="totalMarketCap">0</div>
                        <div>–ö–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—è</div>
                    </div>
                    <div class="market-stat">
                        <div class="market-stat-value" id="totalVolume">0</div>
                        <div>–û–±—ä–µ–º 24—á</div>
                    </div>
                </div>
            </div>
            <div id="coinsContainer" class="coins-grid">
                <!-- –ú–æ–Ω–µ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è -->
            </div>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // Firebase –∫–æ–Ω—Ñ–∏–≥
        const firebaseConfig = {
            apiKey: "AIzaSyDfFyZvoA4PCm4-aMLjK8wCWsWSN5_jmt8",
            authDomain: "famdterm.firebaseapp.com",
            databaseURL: "https://famdterm-default-rtdb.firebaseio.com",
            projectId: "famdterm",
            storageBucket: "famdterm.firebasestorage.app",
            messagingSenderId: "851074938412",
            appId: "1:851074938412:web:0ee0617faca83be5900389"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // ===== –ì–õ–û–ë–ê–õ–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
        let currentUser = null;
        let userBalance = 0;
        let userPortfolio = {};
        let userTrades = [];
        let portfolioChart = null;
        let distributionChart = null;
        let currentTimeframe = 'day';
        
        const ADMIN_DATA = {
            username: "admin",
            password: "Admin123!"
        };

        // ===== –ì–ï–ù–ï–†–ê–¶–ò–Ø –î–ê–ù–ù–´–• –î–õ–Ø –ì–†–ê–§–ò–ö–û–í =====
        function generateChartData(coinId, days = 30) {
            let data = [];
            let basePrice = 100;
            
            // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –º–æ–Ω–µ—Ç—ã
            if (coinId && userPortfolio[coinId]) {
                basePrice = userPortfolio[coinId].averagePrice || 100;
            }
            
            for (let i = 0; i < days; i++) {
                let change = (Math.random() - 0.5) * 10;
                let price = basePrice * (1 + change/100);
                data.push({
                    date: new Date(Date.now() - (days - i) * 24 * 60 * 60 * 1000).toLocaleDateString(),
                    price: price
                });
            }
            return data;
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ì–†–ê–§–ò–ö–û–í =====
        function updateCharts() {
            if (!currentUser || isAdmin()) return;

            // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è
            let portfolioHistory = [];
            let labels = [];
            for (let i = 0; i < 30; i++) {
                labels.push(`–î–µ–Ω—å ${i+1}`);
                let total = userBalance;
                for (let coin of Object.values(userPortfolio)) {
                    total += (coin.averagePrice || 0) * coin.amount * (1 + (Math.random() - 0.5) * 0.1);
                }
                portfolioHistory.push(total);
            }

            // –ì—Ä–∞—Ñ–∏–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è
            const ctx1 = document.getElementById('portfolioChart')?.getContext('2d');
            if (ctx1) {
                if (portfolioChart) portfolioChart.destroy();
                portfolioChart = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è (USDT)',
                            data: portfolioHistory,
                            borderColor: '#4ecdc4',
                            backgroundColor: 'rgba(78, 205, 196, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: { grid: { color: 'rgba(255,255,255,0.1)' } },
                            x: { grid: { display: false } }
                        }
                    }
                });
            }

            // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∫—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã
            let coinNames = [];
            let coinValues = [];
            for (let [id, data] of Object.entries(userPortfolio)) {
                coinNames.push(data.symbol || id);
                coinValues.push((data.averagePrice || 0) * data.amount);
            }

            // –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞
            const ctx2 = document.getElementById('distributionChart')?.getContext('2d');
            if (ctx2) {
                if (distributionChart) distributionChart.destroy();
                distributionChart = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: coinNames.length ? coinNames : ['–ù–µ—Ç –º–æ–Ω–µ—Ç'],
                        datasets: [{
                            data: coinValues.length ? coinValues : [1],
                            backgroundColor: ['#4ecdc4', '#ff6b6b', '#f3ec78', '#45b7d1', '#af4261']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { 
                                labels: { color: 'white' }
                            }
                        }
                    }
                });
            }

            // –ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫–∏
            updateMiniCharts();
        }

        // ===== –ú–ò–ù–ò-–ì–†–ê–§–ò–ö–ò =====
        function updateMiniCharts() {
            const miniContainer = document.getElementById('miniChart');
            if (!miniContainer) return;

            let html = '<div style="display: flex; gap: 10px;">';
            for (let i = 0; i < 10; i++) {
                let height = 20 + Math.random() * 80;
                html += `<div class="mini-bar" style="height: ${height}px;" data-value="${Math.round(height)}"></div>`;
            }
            html += '</div>';
            miniContainer.innerHTML = html;
        }

        // ===== –°–ú–ï–ù–ê –í–†–ï–ú–ï–ù–ù–û–ì–û –ü–ï–†–ò–û–î–ê =====
        function changeTimeframe(timeframe) {
            currentTimeframe = timeframe;
            document.querySelectorAll('.time-filter').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            updateCharts();
        }

        // ===== –†–ê–°–ß–ï–¢ –ü–†–ò–ë–´–õ–ò =====
        function calculateProfit(coinId, coinData) {
            if (!coinData) return { profit: 0, percent: 0 };
            
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É (—Å–∏–º—É–ª–∏—Ä—É–µ–º)
            let currentPrice = coinData.averagePrice * (1 + (Math.random() - 0.5) * 0.2);
            let invested = coinData.averagePrice * coinData.amount;
            let currentValue = currentPrice * coinData.amount;
            let profit = currentValue - invested;
            let percent = (profit / invested) * 100;
            
            return { profit, percent };
        }

        // ===== –ü–†–û–î–ê–ñ–ê –ú–û–ù–ï–¢–´ =====
        function sellCoin(coinId, amount) {
            if (!currentUser || isAdmin()) {
                showToast('‚ùå –ù–µ–ª—å–∑—è –ø—Ä–æ–¥–∞–≤–∞—Ç—å!', 'error');
                return;
            }

            if (!amount || amount <= 0) {
                showToast('‚ùå –í–≤–µ–¥–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ!', 'error');
                return;
            }

            const portfolioRef = database.ref('users/' + currentUser + '/portfolio/' + coinId);
            portfolioRef.once('value', (snapshot) => {
                if (!snapshot.exists()) {
                    showToast('‚ùå –ù–µ—Ç —Ç–∞–∫–æ–π –º–æ–Ω–µ—Ç—ã!', 'error');
                    return;
                }

                const coinData = snapshot.val();
                
                if (coinData.amount < amount) {
                    showToast('‚ùå –°—Ç–æ–ª—å–∫–æ –Ω–µ—Ç!', 'error');
                    return;
                }

                // –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ —Å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å—é
                let currentPrice = coinData.averagePrice * (1 + (Math.random() - 0.5) * 0.1);
                let totalSell = currentPrice * amount;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
                userBalance += totalSell;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Ä—Ç—Ñ–µ–ª—å
                let newAmount = coinData.amount - amount;
                
                if (newAmount > 0) {
                    portfolioRef.update({ amount: newAmount });
                } else {
                    portfolioRef.remove();
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –≤ Firebase
                database.ref('users/' + currentUser).update({
                    balance: userBalance
                });

                // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–¥–µ–ª–∫—É
                let trade = {
                    type: 'SELL',
                    coin: coinId,
                    amount: amount,
                    price: currentPrice,
                    total: totalSell,
                    date: new Date().toISOString()
                };
                
                userTrades.push(trade);

                showToast(`‚úÖ –ü—Ä–æ–¥–∞–Ω–æ ${amount} ${coinData.symbol} –∑–∞ ${totalSell.toFixed(2)} USDT`, 'success');
                loadPortfolio();
                updateUserProfile();
            });
        }

        // ===== –ü–û–ö–ê–ó–ê–¢–¨ –ú–û–î–ê–õ–ö–£ –° –ì–†–ê–§–ò–ö–û–ú =====
        function showCoinChart(coinId, coinData) {
            let chartData = generateChartData(coinId, 30);
            let prices = chartData.map(d => d.price);
            let labels = chartData.map(d => d.date);
            
            let modalHtml = `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #1a2634; padding: 40px; border-radius: 50px; z-index: 2000; width: 600px; border: 3px solid #4ecdc4;">
                    <h2 style="margin-bottom: 20px;">${coinData.name} (${coinData.symbol})</h2>
                    <canvas id="modalChart" width="500" height="300"></canvas>
                    <button onclick="closeModal()" style="margin-top: 30px; padding: 15px 40px; background: #4ecdc4; border: none; border-radius: 30px; cursor: pointer;">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
                <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 1999;" onclick="closeModal()"></div>
            `;
            
            let modal = document.createElement('div');
            modal.id = 'chartModal';
            modal.innerHTML = modalHtml;
            document.body.appendChild(modal);
            
            setTimeout(() => {
                let ctx = document.getElementById('modalChart')?.getContext('2d');
                if (ctx) {
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: '–¶–µ–Ω–∞ USDT',
                                data: prices,
                                borderColor: '#4ecdc4',
                                backgroundColor: 'rgba(78, 205, 196, 0.1)',
                                fill: true
                            }]
                        }
                    });
                }
            }, 100);
        }

        function closeModal() {
            let modal = document.getElementById('chartModal');
            if (modal) modal.remove();
        }

        // ===== UI –§–£–ù–ö–¶–ò–ò =====
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.style.background = type === 'success' ? 'linear-gradient(90deg, #4ecdc4, #45b7d1)' : 
                                   type === 'error' ? 'linear-gradient(90deg, #ff6b6b, #ee5a5a)' : 
                                   'linear-gradient(90deg, #f3ec78, #af4261)';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.remove(), 3000);
        }

        function showRegister() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('registerSection').classList.remove('hidden');
        }

        function showLogin() {
            document.getElementById('registerSection').classList.add('hidden');
            document.getElementById('authSection').classList.remove('hidden');
        }

        // ===== –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø =====
        function register() {
            const username = document.getElementById('regUsername').value.trim();
            const password = document.getElementById('regPassword').value.trim();
            const confirm = document.getElementById('regConfirmPassword').value.trim();

            if (!username || !password || !confirm) {
                showToast('‚ùå –ó–∞–ø–æ–ª–Ω–∏ –ø–æ–ª—è!', 'error');
                return;
            }

            if (password !== confirm) {
                showToast('‚ùå –ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!', 'error');
                return;
            }

            database.ref('users/' + username).once('value', (snapshot) => {
                if (snapshot.exists()) {
                    showToast('‚ùå –ò–º—è –∑–∞–Ω—è—Ç–æ!', 'error');
                    return;
                }

                const userData = {
                    password: password,
                    balance: 10000,
                    portfolio: {},
                    trades: [],
                    registeredAt: new Date().toISOString()
                };

                database.ref('users/' + username).set(userData)
                    .then(() => {
                        showToast('‚úÖ –†–µ–≥–∞ —É—Å–ø–µ—à–Ω–∞!', 'success');
                        showLogin();
                    });
            });
        }

        // ===== –í–•–û–î =====
        function login() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();

            if (!username || !password) {
                showToast('‚ùå –í–≤–µ–¥–∏ –¥–∞–Ω–Ω—ã–µ!', 'error');
                return;
            }

            // –ê–¥–º–∏–Ω
            if (username === ADMIN_DATA.username) {
                if (password === ADMIN_DATA.password) {
                    currentUser = ADMIN_DATA.username;
                    userBalance = Infinity;
                    userPortfolio = {};
                    
                    document.getElementById('authSection').classList.add('hidden');
                    document.getElementById('userInfo').classList.remove('hidden');
                    document.getElementById('adminPanel').classList.remove('hidden');
                    document.getElementById('userProfile').classList.remove('hidden');
                    
                    document.getElementById('profileName').textContent = '–ê–î–ú–ò–ù –í–°–ï–õ–ï–ù–ù–û–ô';
                    document.getElementById('profileAvatar').textContent = 'üëë';
                    document.getElementById('profileBadge').textContent = '‚ö° –ë–û–ì –ö–û–°–ú–û–°–ê';
                    
                    updateUserProfile();
                    loadCoins();
                    showToast('üëë –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ü–æ–≤–µ–ª–∏—Ç–µ–ª—å!', 'success');
                    return;
                } else {
                    showToast('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
                    return;
                }
            }

            // –û–±—ã—á–Ω—ã–π —é–∑–µ—Ä
            database.ref('users/' + username).once('value', (snapshot) => {
                if (!snapshot.exists()) {
                    showToast('‚ùå –ù–µ—Ç —Ç–∞–∫–æ–≥–æ!', 'error');
                    return;
                }

                const userData = snapshot.val();
                if (userData.password !== password) {
                    showToast('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
                    return;
                }

                currentUser = username;
                userBalance = userData.balance || 10000;
                userPortfolio = userData.portfolio || {};
                userTrades = userData.trades || [];

                document.getElementById('authSection').classList.add('hidden');
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('userProfile').classList.remove('hidden');
                
                document.getElementById('profileName').textContent = username;
                document.getElementById('profileAvatar').textContent = username.charAt(0).toUpperCase();
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –±–µ–π–¥–∂ –ø–æ –ø—Ä–æ—Ñ–∏—Ç—É
                let totalProfit = calculateTotalProfit();
                if (totalProfit > 10000) {
                    document.getElementById('profileBadge').textContent = 'üíé –õ–ï–ì–ï–ù–î–ê';
                } else if (totalProfit > 5000) {
                    document.getElementById('profileBadge').textContent = '‚ö° –ü–†–û–§–ò';
                } else if (totalProfit > 1000) {
                    document.getElementById('profileBadge').textContent = 'üåü –¢–†–ï–ô–î–ï–†';
                } else {
                    document.getElementById('profileBadge').textContent = 'üå± –ù–û–í–ò–ß–û–ö';
                }
                
                updateUserProfile();
                loadCoins();
                loadPortfolio();
                updateCharts();
                showToast(`üöÄ –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, ${username}!`, 'success');
            });
        }

        // ===== –í–´–•–û–î =====
        function logout() {
            currentUser = null;
            userBalance = 0;
            userPortfolio = {};
            
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('userInfo').classList.add('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('userProfile').classList.add('hidden');
            
            loadCoins();
            showToast('üëã –ü–æ–∫–∞!', 'info');
        }

        // ===== –ü–û–ü–û–õ–ù–ï–ù–ò–ï =====
        function depositMoney() {
            if (!currentUser || isAdmin()) {
                showToast('‚ùå –ù–µ–ª—å–∑—è –ø–æ–ø–æ–ª–Ω–∏—Ç—å!', 'error');
                return;
            }

            const amount = parseFloat(document.getElementById('depositAmount').value);
            if (!amount || amount <= 0) {
                showToast('‚ùå –í–≤–µ–¥–∏ —Å—É–º–º—É!', 'error');
                return;
            }

            userBalance += amount;
            
            database.ref('users/' + currentUser).update({
                balance: userBalance
            }).then(() => {
                updateUserProfile();
                showToast(`üí∞ +${amount} USDT!`, 'success');
                document.getElementById('depositAmount').value = '';
            });
        }

        // ===== –†–ê–°–ß–ï–¢ –û–ë–©–ï–ô –ü–†–ò–ë–´–õ–ò =====
        function calculateTotalProfit() {
            let totalInvested = 0;
            let totalCurrent = 0;
            
            for (let coin of Object.values(userPortfolio)) {
                totalInvested += coin.averagePrice * coin.amount;
                let currentPrice = coin.averagePrice * (1 + (Math.random() - 0.5) * 0.2);
                totalCurrent += currentPrice * coin.amount;
            }
            
            return totalCurrent - totalInvested;
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–û–§–ò–õ–Ø =====
        function updateUserProfile() {
            if (!currentUser) return;
            
            if (isAdmin()) {
                document.getElementById('usdtBalance').textContent = '‚àû';
                document.getElementById('portfolioValue').textContent = '‚àû';
                document.getElementById('totalProfitAmount').textContent = '‚àû';
                document.getElementById('usdtChange').textContent = '‚àû';
                document.getElementById('portfolioChange').textContent = '‚àû';
                document.getElementById('profitPercent').textContent = '‚àû';
                document.getElementById('totalTrades').textContent = '‚àû';
                document.getElementById('winRate').textContent = '‚àû';
                document.getElementById('totalProfit').textContent = '‚àû';
                return;
            }

            // –ë–∞–ª–∞–Ω—Å
            document.getElementById('usdtBalance').textContent = userBalance.toFixed(2);
            
            // –ü–æ—Ä—Ç—Ñ–µ–ª—å
            let portfolioTotal = 0;
            for (let coin of Object.values(userPortfolio)) {
                let currentPrice = coin.averagePrice * (1 + (Math.random() - 0.5) * 0.1);
                portfolioTotal += currentPrice * coin.amount;
            }
            document.getElementById('portfolioValue').textContent = portfolioTotal.toFixed(2);
            
            // –ü—Ä–∏–±—ã–ª—å
            let totalProfit = calculateTotalProfit();
            document.getElementById('totalProfitAmount').textContent = (totalProfit > 0 ? '+' : '') + totalProfit.toFixed(2);
            document.getElementById('profitPercent').textContent = totalProfit > 0 ? '+5.2%' : '-2.1%';
            
            // –ò–∑–º–µ–Ω–µ–Ω–∏—è
            document.getElementById('usdtChange').innerHTML = `+${(Math.random() * 5).toFixed(2)}% —Å–µ–≥–æ–¥–Ω—è`;
            document.getElementById('portfolioChange').innerHTML = (totalProfit > 0 ? '+' : '') + totalProfit.toFixed(2) + ' USDT';
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
            let totalTrades = userTrades.length;
            let wins = userTrades.filter(t => t.type === 'SELL' && t.price > t.price * 0.9).length;
            document.getElementById('totalTrades').textContent = totalTrades;
            document.getElementById('winRate').textContent = totalTrades ? ((wins / totalTrades) * 100).toFixed(0) + '%' : '0%';
            document.getElementById('totalProfit').textContent = totalProfit.toFixed(2);
        }

        // ===== –ó–ê–ì–†–£–ó–ö–ê –ü–û–†–¢–§–ï–õ–Ø =====
        function loadPortfolio() {
            if (!currentUser || isAdmin()) {
                document.getElementById('portfolioContainer').innerHTML = 
                    '<div class="empty-state">‚ú® –ö—É–ø–∏ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –º–æ–Ω–µ—Ç—É!</div>';
                return;
            }

            const portfolioRef = database.ref('users/' + currentUser + '/portfolio');
            portfolioRef.on('value', (snapshot) => {
                userPortfolio = snapshot.val() || {};
                updateUserProfile();
                updateCharts();
                
                const container = document.getElementById('portfolioContainer');
                
                if (Object.keys(userPortfolio).length === 0) {
                    container.innerHTML = '<div class="empty-state">üöÄ –û—Ç–∫—Ä–æ–π –∫–æ—Å–º–æ—Å - –∫—É–ø–∏ –º–æ–Ω–µ—Ç!</div>';
                    return;
                }

                let html = '';
                for (let [coinId, coinData] of Object.entries(userPortfolio)) {
                    let profit = calculateProfit(coinId, coinData);
                    let currentPrice = coinData.averagePrice * (1 + (Math.random() - 0.5) * 0.2);
                    
                    html += `
                        <div class="portfolio-card">
                            <div class="portfolio-coin-header">
                                <span class="portfolio-coin-name">${coinData.name || coinId}</span>
                                <span class="portfolio-coin-symbol">${coinData.symbol || coinId}</span>
                            </div>
                            <div class="portfolio-coin-details">
                                <div class="portfolio-coin-stat">
                                    <div class="portfolio-coin-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</div>
                                    <div class="portfolio-coin-value">${coinData.amount}</div>
                                </div>
                                <div class="portfolio-coin-stat">
                                    <div class="portfolio-coin-label">–°—Ä. —Ü–µ–Ω–∞</div>
                                    <div class="portfolio-coin-value">${coinData.averagePrice.toFixed(2)}</div>
                                </div>
                                <div class="portfolio-coin-stat">
                                    <div class="portfolio-coin-label">–¢–µ–∫. —Ü–µ–Ω–∞</div>
                                    <div class="portfolio-coin-value">${currentPrice.toFixed(2)}</div>
                                </div>
                                <div class="portfolio-coin-stat">
                                    <div class="portfolio-coin-label">–°—Ç–æ–∏–º–æ—Å—Ç—å</div>
                                    <div class="portfolio-coin-value">${(currentPrice * coinData.amount).toFixed(2)}</div>
                                </div>
                            </div>
                            <div class="portfolio-coin-profit ${profit.profit >= 0 ? 'profit-positive' : 'profit-negative'}">
                                ${profit.profit >= 0 ? 'üìà +' : 'üìâ '}${profit.profit.toFixed(2)} USDT (${profit.percent.toFixed(2)}%)
                            </div>
                            <div class="portfolio-coin-actions">
                                <div style="flex: 1; display: flex; gap: 10px;">
                                    <input type="number" id="sell-${coinId}" placeholder="–ö–æ–ª-–≤–æ" min="1" max="${coinData.amount}">
                                    <button onclick="sellCoin('${coinId}', parseFloat(document.getElementById('sell-${coinId}').value))" class="btn-sell">
                                        üí∞ –ü–†–û–î–ê–¢–¨
                                    </button>
                                </div>
                                <button onclick="showCoinChart('${coinId}', ${JSON.stringify(coinData).replace(/"/g, '&quot;')})" class="btn-chart">
                                    üìä –ì–†–ê–§–ò–ö
                                </button>
                            </div>
                        </div>
                    `;
                }
                
                container.innerHTML = html;
            });
        }

        // ===== –ü–†–û–í–ï–†–ö–ê –ê–î–ú–ò–ù–ê =====
        function isAdmin() {
            return currentUser === ADMIN_DATA.username;
        }

        // ===== –°–û–ó–î–ê–ù–ò–ï –ú–û–ù–ï–¢–´ =====
        function createCoin() {
            if (!isAdmin()) {
                showToast('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω!', 'error');
                return;
            }

            const name = document.getElementById('coinName').value.trim();
            const symbol = document.getElementById('coinSymbol').value.trim().toUpperCase();
            const price = parseFloat(document.getElementById('coinPrice').value);
            const supply = parseInt(document.getElementById('coinSupply').value);
            const volatility = parseFloat(document.getElementById('coinVolatility').value) || 5;

            if (!name || !symbol || !price || !supply) {
                showToast('‚ùå –ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!', 'error');
                return;
            }

            const coinId = symbol.toLowerCase();
            
            database.ref('coins/' + coinId).once('value', (snapshot) => {
                if (snapshot.exists()) {
                    showToast('‚ùå –¢–∞–∫–∞—è —É–∂–µ –µ—Å—Ç—å!', 'error');
                    return;
                }

                const coinData = {
                    name: name,
                    symbol: symbol,
                    price: price,
                    supply: supply,
                    volatility: volatility,
                    createdBy: currentUser,
                    createdAt: new Date().toISOString(),
                    priceHistory: generateChartData(null, 30).map(d => d.price)
                };

                database.ref('coins/' + coinId).set(coinData)
                    .then(() => {
                        showToast(`‚úÖ –ú–æ–Ω–µ—Ç–∞ ${name} —Å–æ–∑–¥–∞–Ω–∞!`, 'success');
                        document.getElementById('coinName').value = '';
                        document.getElementById('coinSymbol').value = '';
                        document.getElementById('coinPrice').value = '';
                        document.getElementById('coinSupply').value = '';
                        document.getElementById('coinVolatility').value = '';
                        loadCoins();
                    });
            });
        }

        // ===== –£–î–ê–õ–ï–ù–ò–ï –ú–û–ù–ï–¢–´ =====
        function deleteCoin(coinId) {
            if (!isAdmin()) {
                showToast('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω!', 'error');
                return;
            }

            if (confirm('üíÄ –£–¥–∞–ª–∏—Ç—å –º–æ–Ω–µ—Ç—É?')) {
                database.ref('coins/' + coinId).remove()
                    .then(() => {
                        showToast('‚úÖ –ú–æ–Ω–µ—Ç–∞ —É–¥–∞–ª–µ–Ω–∞!', 'success');
                        loadCoins();
                    });
            }
        }

        // ===== –ü–û–ö–£–ü–ö–ê –ú–û–ù–ï–¢–´ =====
        function buyCoin(coinId, amount) {
            if (!currentUser) {
                showToast('‚ùå –°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏!', 'error');
                return;
            }

            if (!amount || amount <= 0) {
                showToast('‚ùå –í–≤–µ–¥–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ!', 'error');
                return;
            }

            const coinRef = database.ref('coins/' + coinId);
            coinRef.once('value', (snapshot) => {
                if (!snapshot.exists()) {
                    showToast('‚ùå –ù–µ—Ç –º–æ–Ω–µ—Ç—ã!', 'error');
                    return;
                }

                const coin = snapshot.val();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ü–µ–Ω—ã
                let volatility = coin.volatility || 5;
                let priceChange = (Math.random() - 0.5) * volatility / 100;
                let currentPrice = coin.price * (1 + priceChange);
                
                let totalCost = currentPrice * amount;

                if (!isAdmin() && userBalance < totalCost) {
                    showToast('‚ùå –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ–Ω–µ–≥!', 'error');
                    return;
                }

                if (coin.supply < amount) {
                    showToast('‚ùå –ù–µ—Ç —Å—Ç–æ–ª—å–∫–æ!', 'error');
                    return;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
                if (!isAdmin()) {
                    userBalance -= totalCost;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
                coinRef.update({ 
                    supply: coin.supply - amount,
                    price: currentPrice
                });

                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Ä—Ç—Ñ–µ–ª—å
                const userPortfolioRef = database.ref('users/' + currentUser + '/portfolio/' + coinId);
                userPortfolioRef.once('value', (portfolioSnapshot) => {
                    let currentAmount = portfolioSnapshot.exists() ? portfolioSnapshot.val().amount : 0;
                    
                    let newData = {
                        amount: currentAmount + amount,
                        symbol: coin.symbol,
                        name: coin.name,
                        averagePrice: currentPrice
                    };

                    userPortfolioRef.set(newData);
                    
                    if (!isAdmin()) {
                        database.ref('users/' + currentUser).update({
                            balance: userBalance
                        });
                    }

                    // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–¥–µ–ª–∫—É
                    let trade = {
                        type: 'BUY',
                        coin: coinId,
                        amount: amount,
                        price: currentPrice,
                        total: totalCost,
                        date: new Date().toISOString()
                    };
                    
                    userTrades.push(trade);

                    showToast(`‚úÖ –ö—É–ø–ª–µ–Ω–æ ${amount} ${coin.symbol}!`, 'success');
                    loadCoins();
                    loadPortfolio();
                    updateCharts();
                });
            });
        }

        // ===== –ó–ê–ì–†–£–ó–ö–ê –ú–û–ù–ï–¢ =====
        function loadCoins() {
            database.ref('coins').on('value', (snapshot) => {
                const coins = snapshot.val();
                const container = document.getElementById('coinsContainer');
                
                if (!coins) {
                    container.innerHTML = '<div class="empty-state">üåå –ê–¥–º–∏–Ω, —Å–æ–∑–¥–∞–π –º–æ–Ω–µ—Ç—ã!</div>';
                    return;
                }

                let totalMarketCap = 0;
                let totalVolume = 0;

                let html = '';
                for (let [id, coin] of Object.entries(coins)) {
                    // –°–ª—É—á–∞–π–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞
                    let volatility = coin.volatility || 5;
                    let priceChange = (Math.random() - 0.5) * volatility / 100;
                    let currentPrice = coin.price * (1 + priceChange);
                    let priceChangePercent = priceChange * 100;
                    
                    totalMarketCap += currentPrice * coin.supply;
                    totalVolume += currentPrice * coin.supply * 0.1; // 10% –æ–±—ä–µ–º–∞
                    
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –º–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫
                    let chartBars = [];
                    for (let i = 0; i < 10; i++) {
                        let barHeight = 30 + Math.random() * 70;
                        chartBars.push(`<div class="coin-chart-bar" style="height: ${barHeight}px;"></div>`);
                    }

                    html += `
                        <div class="coin-card ${coin.createdBy === 'admin' ? 'admin-coin' : ''}">
                            <div class="coin-header">
                                <span class="coin-name">${coin.name}</span>
                                <span class="coin-symbol">${coin.symbol}</span>
                            </div>
                            
                            <div class="coin-chart-mini">
                                ${chartBars.join('')}
                            </div>
                            
                            <div class="coin-price-section">
                                <span class="coin-price">${currentPrice.toFixed(2)}</span>
                                <span class="coin-price-change ${priceChangePercent >= 0 ? 'change-positive' : 'change-negative'}">
                                    ${priceChangePercent >= 0 ? '‚ñ≤' : '‚ñº'} ${Math.abs(priceChangePercent).toFixed(2)}%
                                </span>
                            </div>
                            
                            <div class="coin-supply">
                                üì¶ –í –æ–±—Ä–∞—â–µ–Ω–∏–∏: ${coin.supply.toLocaleString()} ${coin.symbol}
                            </div>
                            
                            ${currentUser ? `
                                <div class="coin-actions">
                                    <div class="buy-section">
                                        <input type="number" id="amount-${id}" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" min="1" max="${coin.supply}">
                                        <button onclick="buyCoin('${id}', parseFloat(document.getElementById('amount-${id}').value))" class="btn-buy">
                                            üöÄ –ö–£–ü–ò–¢–¨
                                        </button>
                                    </div>
                                    ${isAdmin() ? `
                                        <button onclick="deleteCoin('${id}')" class="btn-delete">
                                             –£–î–ê–õ–ò–¢–¨
                                        </button>
                                    ` : ''}
                                </div>
                            ` : ''}
                        </div>
                    `;
                }

                document.getElementById('totalMarketCap').textContent = totalMarketCap.toFixed(2) + 'M';
                document.getElementById('totalVolume').textContent = totalVolume.toFixed(2) + 'M';
                
                container.innerHTML = html;
            });
        }

        // –°—Ç–∞—Ä—Ç
        loadCoins();
        setInterval(() => {
            if (currentUser) {
                updateUserProfile();
                updateCharts();
            }
        }, 5000); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
    </script>
</body>
</html>
